<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Final Submission</title>
  <!-- ê³µìš© CSS (index, choose ë“±ì—ì„œ ì‚¬ìš©í•˜ëŠ” ìŠ¤íƒ€ì¼) -->
  <link rel="stylesheet" href="style.css">
  <style>
    /* ì¤‘ì•™ì— ë‚´ìš© ë°°ì¹˜ë¥¼ ìœ„í•œ ì»¨í…Œì´ë„ˆ */
    .final-content {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    /* Header ìŠ¤íƒ€ì¼ */
    header.choose-header {
      text-align: center;
      padding: 20px 0;
      background-color: #001f3f;
      color: #fff;
      margin-bottom: 30px;
    }
    header.choose-header h1 {
      font-size: 2rem;  /* í•„ìš”ì— ë”°ë¼ ì¡°ì ˆ */
      font-weight: bold;
      margin: 0;
    }
    .step-indicator {
      display: inline-block;
      width: 40px;
      height: 40px;
      line-height: 40px;
      border-radius: 50%;
      background-color: #00BCD4;
      color: #fff;
      font-weight: bold;
      text-align: center;
      margin-right: 10px;
      font-size: 1.2rem;
      vertical-align: middle;
    }
    /* Venmo ì…ë ¥ë€ ê·¸ë£¹ (ì™¼ìª½ ì •ë ¬) */
    .venmo-group {
      margin-bottom: 20px;
    }
    .venmo-group label {
      font-weight: bold;
      font-size: 1.2rem;
      display: block;
      margin-bottom: 5px;
      color: #001f3f;
    }
    .venmo-group input {
      width: 100%;
      max-width: 500px;
      font-size: 1rem;
      padding: 8px;
      box-sizing: border-box;
    }
    /* Terms & Disclaimer ì œëª© */
    .terms-title {
      font-weight: bold;
      font-size: 1.2rem;
      margin-bottom: 10px;
      color: #001f3f;
    }
    /* Terms & Disclaimer ë‚´ìš© ë°•ìŠ¤ */
    .terms-box {
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid #ccc;
      padding: 10px;
      margin-bottom: 20px;
      line-height: 1.4;
      font-size: 0.8rem;
    }
    /* ë™ì˜ ì²´í¬ë°•ìŠ¤ ê·¸ë£¹ (ì™¼ìª½ ì •ë ¬) */
    .agree-group {
      margin-bottom: 20px;
    }
    .agree-group label {
      font-weight: bold;
      font-size: 1rem;
      color: #001f3f;
    }
    /* ì•ˆë‚´ ë¬¸êµ¬ (ê°€ìš´ë° ì •ë ¬) */
    .choose-subtext {
      text-align: center;
      font-size: 1.2rem;
      line-height: 1.5;
      margin-bottom: 20px;
    }
    /* ì œì¶œ í¼ ë° ë²„íŠ¼ ì˜ì—­ */
    form {
      margin: 0;
    }
    .buttons {
      display: flex;
      gap: 20px;
      margin-top: 20px;
      justify-content: center;
    }
    .buttons button {
      padding: 10px 20px;
      font-size: 1rem;
      font-weight: bold;
      background-color: #00BCD4;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .buttons button:hover {
      background-color: #FF69B4;
    }
    .buttons button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
    }
    #finalStatus {
      margin-top: 20px;
      font-weight: bold;
      text-align: center;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="choose-header">
    <h1><span class="step-indicator">3</span> Final Submission</h1>
  </header>

  <!-- ì¤‘ì•™ ì»¨í…ì¸  ì˜ì—­ -->
  <div class="final-content">
    <!-- 1. Venmo ì…ë ¥ë€ (ì™¼ìª½ ì •ë ¬) -->
    <div class="venmo-group">
      <label for="venmoId" style="font-weight: bold; font-size: 1.2rem;">
        âœ… Venmo: Name &amp; @username <span style="font-size: 0.9rem; color: #666;">(for sender verification)</span>
      </label>
      <input type="text" id="venmoId" name="venmoId" placeholder="Name &amp; @username (e.g., John Doe &amp; @johndoe)" required>
      <p style="font-size: 0.9rem; color: #666; margin-top: 5px;">
        ğŸ’¡ To avoid any duplicate Names, please make sure to also include your @Username.
      </p>
    </div>

    <!-- 2. Terms & Disclaimer (ì™¼ìª½ ì •ë ¬) -->
    <div class="terms-title">
      âœ… Smart Talent Matcher â€“ Terms and Disclaimer
    </div>
    <div class="terms-box">
      <ol>
        <li>
          <strong>Data Privacy &amp; Security</strong>
          <ol>
            <li>We do not store, share, or sell your personal information or email content beyond the scope of this service.</li>
            <li>Your submitted data is stored only for the duration of the service and is permanently deleted thereafter.</li>
          </ol>
        </li>
        <li>
          <strong>Email Delivery &amp; Targeting</strong>
          <ol>
            <li>We do not guarantee successful email delivery due to factors beyond our control (e.g., issues with recipient email servers).</li>
            <li>Our email list may include invalid or undeliverable addresses. We do not guarantee that all emails will be successfully delivered.</li>
            <li>While we target your selected region and category, the email list may include contacts outside your specific focus (e.g., unrelated fields or industries).</li>
          </ol>
        </li>
        <li>
          <strong>User Conduct &amp; Service Limitations</strong>
          <ol>
            <li>You agree not to use this service for spamming, harassment, or any illegal activities. Any misuse will result in immediate termination of access without refund.</li>
            <li>Our obligation is limited to sending mass emails to the recipients you have selected. We do not take responsibility for any outcomes, responses, or lack thereof after the emails have been sent.</li>
            <li>We do not engage in follow-ups, negotiations, or any actions beyond the initial email delivery.</li>
          </ol>
        </li>
        <li>
          <strong>Payments &amp; Refunds</strong>
          <ol>
            <li>All payments are final and non-refundable, including partial payments. Full payment is required before we begin processing your campaign.</li>
            <li>Once payment is completed, work begins immediately, and refunds are not available under any circumstances. Please ensure your selections and details are correct before proceeding with payment.</li>
          </ol>
        </li>
        <li>
          <strong>Liability &amp; Legal Protection</strong>
          <ol>
            <li>We are not liable for any damages resulting from the use of this service, including but not limited to lost opportunities, miscommunication, or system failures.</li>
            <li>We are not responsible for delays caused by unforeseen circumstances or technical issues.</li>
            <li>By using this service, you waive your right to file any lawsuit, claim, or legal action against Smart Talent Matcher and its affiliates.</li>
          </ol>
        </li>
      </ol>
    </div>

    <!-- 3. ë™ì˜ ì²´í¬ë°•ìŠ¤ (ì™¼ìª½ ì •ë ¬) -->
    <div class="agree-group">
      <label>
        <input type="checkbox" id="agreeCheck">
        I understand and agree to the terms above.
      </label>
    </div>

    <!-- 4. ì•ˆë‚´ ë¬¸êµ¬ (ê°€ìš´ë° ì •ë ¬) -->
    <div class="choose-subtext">
      <p>
        Please review your details carefully before submitting.<br>
        <span style="color: #00bc00; font-weight: bold;">Once submitted, no further changes can be made.</span>
      </p>
    </div>

    <!-- 5. ìµœì¢… ì œì¶œ í¼ (ìˆ¨ì€ í•„ë“œ í¬í•¨) -->
    <form id="finalForm">
      <!-- Hidden í•„ë“œ: visible Venmo ê°’ì„ ì œì¶œ ì „ì— ë³µì‚¬ -->
      <input type="hidden" id="venmoHidden" name="venmoId">
      <input type="hidden" id="orderId" name="orderId">
      <input type="hidden" id="emailAddress" name="emailAddress">
      <input type="hidden" id="emailSubject" name="emailSubject">
      <input type="hidden" id="actingReel" name="actingReel">
      <input type="hidden" id="resumeLink" name="resumeLink">
      <input type="hidden" id="introduction" name="introduction">
      <div class="buttons">
        <button type="button" id="goBackBtn">Go Back to Edit</button>
        <button type="submit" id="submitBtn" disabled>Yes, Submit Now</button>
      </div>
    </form>
    <p id="finalStatus"></p>
  </div>

  <script>
    // hidden í•„ë“œì— localStorage ë°ì´í„°ë¥¼ ì±„ì›Œë„£ê¸°
    document.getElementById("orderId").value = localStorage.getItem("orderId") || "";
    document.getElementById("emailAddress").value = localStorage.getItem("emailAddress") || "";
    document.getElementById("emailSubject").value = localStorage.getItem("emailSubject") || "";
    document.getElementById("actingReel").value = localStorage.getItem("actingReel") || "";
    document.getElementById("resumeLink").value = localStorage.getItem("resumeLink") || "";
    document.getElementById("introduction").value = localStorage.getItem("introduction") || "";

    const agreeCheck = document.getElementById("agreeCheck");
    const venmoInput = document.getElementById("venmoId");
    const venmoHidden = document.getElementById("venmoHidden");
    const submitBtn = document.getElementById("submitBtn");
    const goBackBtn = document.getElementById("goBackBtn");
    const finalForm = document.getElementById("finalForm");
    const finalStatus = document.getElementById("finalStatus");

    function checkEnableSubmit() {
      submitBtn.disabled = !(venmoInput.value.trim() !== "" && agreeCheck.checked);
    }
    venmoInput.addEventListener("input", checkEnableSubmit);
    agreeCheck.addEventListener("change", checkEnableSubmit);

    goBackBtn.addEventListener("click", () => {
      history.back();
    });

    finalForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      finalStatus.textContent = "Submitting final details...";
      finalStatus.style.color = "blue";
      // visible Venmo ê°’ì„ hidden í•„ë“œì— ë³µì‚¬
      venmoHidden.value = venmoInput.value;
      
      const formData = new FormData(finalForm);
      try {
        const response = await fetch("/final-submit", {
          method: "POST",
          body: formData
        });
        const result = await response.json();
        if (result.success) {
          finalStatus.textContent = "Submission complete: Invoice sent! Check your inbox.";
          finalStatus.style.color = "green";
        } else {
          finalStatus.textContent = "Submission failed. Please try again.";
          finalStatus.style.color = "red";
        }
      } catch (err) {
        console.error(err);
        finalStatus.textContent = "Error submitting final details.";
        finalStatus.style.color = "red";
      }
    });
  </script>
</body>
</html>